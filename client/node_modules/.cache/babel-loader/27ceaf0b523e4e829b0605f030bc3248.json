{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\")),\n    _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\")),\n    _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\")),\n    _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\")),\n    _possibleConstructorReturn2 = _interopRequireDefault(require(\"@babel/runtime/helpers/possibleConstructorReturn\")),\n    _getPrototypeOf2 = _interopRequireDefault(require(\"@babel/runtime/helpers/getPrototypeOf\")),\n    _inherits2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inherits\")),\n    _scatterjsCore = require(\"scatterjs-core\"),\n    proxy = function proxy(a, b) {\n  return new Proxy(a, b);\n},\n    ScatterEOS =\n/*#__PURE__*/\nfunction (a) {\n  function b() {\n    return (0, _classCallCheck2.default)(this, b), (0, _possibleConstructorReturn2.default)(this, (0, _getPrototypeOf2.default)(b).call(this, _scatterjsCore.Blockchains.EOS, _scatterjsCore.PluginTypes.BLOCKCHAIN_SUPPORT));\n  }\n\n  return (0, _inherits2.default)(b, a), (0, _createClass2.default)(b, [{\n    key: \"hookProvider\",\n    value: function hookProvider(a) {\n      return function (b) {\n        return new Promise(function (c, d) {\n          var e = Object.assign(b, {\n            blockchain: _scatterjsCore.Blockchains.EOS,\n            network: a,\n            requiredFields: {}\n          });\n\n          _scatterjsCore.SocketService.sendApiRequest({\n            type: \"requestSignature\",\n            payload: e\n          }).then(function (a) {\n            return c(a.signatures);\n          }).catch(function (a) {\n            return d(a);\n          });\n        });\n      };\n    }\n  }, {\n    key: \"signatureProvider\",\n    value: function signatureProvider() {\n      var a = 0 >= arguments.length ? void 0 : arguments[0]; // Protocol will be deprecated.\n\n      return function (b, c) {\n        var d = 2 < arguments.length && void 0 !== arguments[2] ? arguments[2] : {};\n        if (b = _scatterjsCore.Network.fromJson(b), !b.isValid()) throw Error.noNetwork();\n        var e = \"\".concat(b.protocol, \"://\").concat(b.hostport()),\n            f = b.hasOwnProperty(\"chainId\") && b.chainId.length ? b.chainId : d.chainId; // The proxy stands between the eosjs object and scatter.\n        // This is used to add special functionality like adding `requiredFields` arrays to transactions\n\n        return proxy(c({\n          httpEndpoint: e,\n          chainId: f\n        }), {\n          get: function get(g, h) {\n            var i = null;\n            return function () {\n              for (var g = arguments.length, j = Array(g), k = 0; k < g; k++) {\n                j[k] = arguments[k];\n              }\n\n              if (j.find(function (a) {\n                return a.hasOwnProperty(\"keyProvider\");\n              })) throw Error.usedKeyProvider(); // The signature provider which gets elevated into the user's Scatter\n\n              var l =\n              /*#__PURE__*/\n              function () {\n                var c = (0, _asyncToGenerator2.default)(\n                /*#__PURE__*/\n                _regenerator.default.mark(function c(d) {\n                  var e, f, g, h;\n                  return _regenerator.default.wrap(function (c) {\n                    for (;;) {\n                      switch (c.prev = c.next) {\n                        case 0:\n                          return a(), e = j.find(function (a) {\n                            return a.hasOwnProperty(\"requiredFields\");\n                          }) || {\n                            requiredFields: {}\n                          }, f = Object.assign(d, {\n                            blockchain: _scatterjsCore.Blockchains.EOS,\n                            network: b,\n                            requiredFields: e.requiredFields\n                          }), c.next = 5, _scatterjsCore.SocketService.sendApiRequest({\n                            type: \"requestSignature\",\n                            payload: f\n                          });\n\n                        case 5:\n                          if (g = c.sent, g) {\n                            c.next = 8;\n                            break;\n                          }\n\n                          return c.abrupt(\"return\", null);\n\n                        case 8:\n                          if (!g.hasOwnProperty(\"signatures\")) {\n                            c.next = 13;\n                            break;\n                          }\n\n                          return i = g.returnedFields, h = j.find(function (a) {\n                            return a.hasOwnProperty(\"signProvider\");\n                          }), h && g.signatures.push(h.signProvider(d.buf, d.sign)), c.abrupt(\"return\", g.signatures);\n\n                        case 13:\n                          return c.abrupt(\"return\", g);\n\n                        case 14:\n                        case \"end\":\n                          return c.stop();\n                      }\n                    }\n                  }, c, this);\n                }));\n                return function () {\n                  return c.apply(this, arguments);\n                };\n              }();\n\n              return new Promise(function (a, b) {\n                var g = c(Object.assign(d, {\n                  httpEndpoint: e,\n                  signProvider: l,\n                  chainId: f\n                }));\n                g[h].apply(g, j).then(function (b) {\n                  // Standard method ( ie. not contract )\n                  if (!b.hasOwnProperty(\"fc\")) return b = Object.assign(b, {\n                    returnedFields: i\n                  }), void a(b); // Catching chained promise methods ( contract .then action )\n\n                  var c = proxy(b, {\n                    get: function get(a, b) {\n                      return \"then\" === b ? a[b] : function () {\n                        for (var c = arguments.length, d = Array(c), e = 0; e < c; e++) {\n                          d[e] = arguments[e];\n                        }\n\n                        return new Promise(\n                        /*#__PURE__*/\n                        function () {\n                          var c = (0, _asyncToGenerator2.default)(\n                          /*#__PURE__*/\n                          _regenerator.default.mark(function c(e, f) {\n                            return _regenerator.default.wrap(function (c) {\n                              for (;;) {\n                                switch (c.prev = c.next) {\n                                  case 0:\n                                    a[b].apply(a, d).then(function (a) {\n                                      e(Object.assign(a, {\n                                        returnedFields: i\n                                      }));\n                                    }).catch(f);\n\n                                  case 1:\n                                  case \"end\":\n                                    return c.stop();\n                                }\n                              }\n                            }, c, this);\n                          }));\n                          return function () {\n                            return c.apply(this, arguments);\n                          };\n                        }());\n                      };\n                    }\n                  });\n                  a(c);\n                }).catch(function (a) {\n                  return b(a);\n                });\n              });\n            };\n          }\n        }); // Proxy\n      };\n    }\n  }]), b;\n}(_scatterjsCore.Plugin);\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: !0\n}), exports.default = void 0;\nexports.default = ScatterEOS, \"undefined\" != typeof window && (window.ScatterEOS = ScatterEOS);","map":null,"metadata":{},"sourceType":"script"}